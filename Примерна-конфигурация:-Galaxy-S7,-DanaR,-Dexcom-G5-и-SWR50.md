(тази статия е превод на https://github.com/MilosKozak/AndroidAPS/wiki/Beispiel-Konfiguration-Galaxy-S7,-DanaR,-Dexcom-G5-und-SWR50 )
![](https://user-images.githubusercontent.com/32912987/34470732-6a3b4b62-ef38-11e7-8428-03e1aec39ee7.png)
## Предговор
В този вариант смартфонът Samsung Galaxy S7 е "сърцето" и контролния център на APS системата. Той има инсталирана официалната, но леко променена Dexcom апликация от системата за непрекъснато измерване на глюкоза Dexcom G5 и контролира въз основа на тези данни приложението "AndroidAPS" (често наричан АПС),  DanaR инсулинова помпа на SOOIL (чрез ръчно въвеждане на предложенията на приложението или напълно автоматичен след включване на затворен цикъл). Не са необходими други устройства.

Изборът на звуците за аларми при прекалено високи или прекалено ниски нива на кръвната захар не е голявям в оригиналното приложение на Dexcom (то предлага едва няколко предварително определени такива), но приложението "xDrip +" може да го замести в смартфона в зависимост от индивидуалните нужди. Чрез него (xDrip+)  могат да се настроят различни алармени звуци или вибрации в зависимост от часа на деня или нощта.

Ако желаете, всички данни за глюкозата и лечението могат да бъдат показани на "Sony Smartwatch 3" (SWR50) на китката. Тази „умна” джаджа може след това да бъде използвана, за напр. дискретно стартиране на  болус за хранене.

Системата работи в офлайн режим, т.е. без да е необходима връзка на смартфона към интернет.

Въпреки това, при осъществяване на връзка с интернет, данните за вече направените лечения ( болуси, временни базали и т.н.), автоматично ще бъдат качени NightScout "облака", за да можете да получите цялостна оценка на състоянието пти посещение на лекар, или по всяко време да споделяте текущите стойности с членовете на семейството.

## Необходими компоненти
### 1.	Samsung Galaxy S7
От къде да го намерите:  търговци на електроника, интернет магазини, мобилни оператори

Алтернативи: виж Android смартфони в Списъка на Dexcom съвместимост (точка "Dexcom G5 всички мобилни приложения", а не в "приложение Последователи Dexcom" име)

### 2.	Dana R инсулинова помпа
От къде: В България по предписание на ендокринолог или частно чрез фирмата дистрибутор 

Алтернативи: Accu-Chek Combo, DanaRS (вече се поддържа от AAPS, но все още не се предлага в България), Accu-Chek Insight (в разработка)

### 3.	Dexcom G5
От къде: Няма официален доставчик за Бъллгария, за това повечето хора ги поръчват от дистрибуторите в Чехия или Англия, също можете да се включите в груповите поръчки организирани доста често във Facebook групата Найтскаут България

Алтернативи: MM640g-CGM (да се чете директно чрез AAPS), Dexcom G4 със Share приемник (чрез xDrip +), Ever Sense (чрез xDrip +), Freestyle Libre DIY-CGM с Bluecon Night Rider, Blue reader, или манипулиран SmartWatch 3 на Sony (SWR50) директно върху сензора

### 4.	Опция: Sony Smartwatch 3 (SWR50)
От къде: Тъй като часовникът вече не се произвежда, може да се наложи да търсите втора ръка ( olx, ebay)  или в интернет.  Ако го намерите на приемлива цена дори в ярки неонови цветове – можете да го поръчате, а след така или иначе и да смените силиконовата лента . За да я смените, потърсете в eBay за "SWR50 adapter" – адаптери, в коит часовника точно се вписва и можете да използвате всяка гривна (в подходящия размер).
Алтернативи: Android Wear Smartwatches

## Настройка на Nightscout 
Nightscout.info е уеб сайт, който съхранява повечето от данните за вашия APS "в облака". Това позволява обширна статистика и анализ, но и синхронизиране на данните с други устройства или споделянето им с членове на семейството, приятели или лекари.

### 1.	Nightscout в Heroku
За да направите това, следвайте инструкциите по-долу: http://www.nightscout.info/wiki/welcome/set-up-nightscout-using-heroku

Съвет: Запишете всички данни за достъп( пароли и т.н.)  на лист хартия или в текстов файл!

### 2.	Настройте променливите на Heroku
* Влезте в https://herokuapp.com/
* Изберете името на приложението
* Settings > изберете "Reveal Config Vars" 
* Добавете променливи или променете, както следва:
ENABLE = careportal food cage sage iage iob cob basal rawbg pushover bgi pump openaps openapsbasal loop
DEVICESTATUS_ADVANCED = true
PUMP_FIELDS = reservoir battery clock
Аларма при ниско ниво на батерията на помпата (в %) може да се активират, както следва:
PUMP_WARN_BATT_P = 51
PUMP_URGENT_BATT_P = 26
### 3.	Проверете версията на уебсайта на Nightscout
Отворете https://вашетоИме.herokuapp.com/
Кликнете върху трите хоризонтални ленти в горната дясна част на екрана (менюто)
В долния край на менюто трябва да има "Nightscout version 0.10.2 -..."
Съвет: Ако се показва по-стара версия, напр. "0.10.1 -...", Nightscout се нуждае от актуализиране. За да го обновите следваите инструкциите на http://www.nightscout.info/wiki/welcome/how-to-update-to-latest-cgm-remote-monitor-aka-cookie. Ако въпреки успешна актуализация показаната версия не се актуализира, дори след ръчен "Redeploy", вижте инструкциите в http://www.nightscout.info/wiki/welcome/how-to-update-to-latest-cgm-remote-monitor-aka-cookie/update-my-fork-troubleshooting-part-2.
## Подгответе компютъра / ноутбука
За да можете сами да създадете приложение за Android от кода на AAPS, на компютъра или ноутбука се изисква да има инсталирано Android Studio (Windows, Mac, Linux)> Подробности има на адрес https://developer.android.com/studio /install.html
## Настройте своя смартфон
<img src="https://user-images.githubusercontent.com/32912987/34470734-6ee34ade-ef38-11e7-9214-337a9c607243.png" width="250">
### Проверете фърмуера на Samsung Galaxy S7
Меню> Настройки> Информация за телефона> Информация за софтуера: Тук трябва да бъде проверена версията на фърмуера да бъде: "Android version 7.0”
Ако не е: Меню> Настройки> Актуализиране на софтуера
### Разрешаване на инсталирането на неизвестни източници
Меню> Настройки> Заключен екран и защита> Неизвестни източници> Плъзгач надясно (= активно)

От съображения за сигурност тази настройка трябва да бъде деактивирана отново, когато инсталирането на всички описани тук приложения е завършено.

### Активирайте Bluetooth
Меню> Настройки> Връзки> Bluetooth> Плъзгач надясно (= активен)

## Инсталирайте приложението на Dexcom (модифицирана версия)
 
Оригиналното приложение за Dexcom от Google Play Store няма да работи, защото не предава стойностите към други приложения. Ето защо е необходима леко модифицирана версия на програмата. Само тя по-късно може да комуникира с AAPS. От адрес https://github.com/dexcomapp/dexcomapp?files=1 можете да свалите версии в ммол / л и мг / дл на модифицираното приложение Dexcom. Предимство над безплатните приложения като xDrip + е, че то използва метода на изчисление и отчитане на глюкоза на самия производител, както и да бъдат запълвани "пропуснати стойности" при повторното свързване (което вече може и xDrip +).

За да направите това в смартфона, изпълнете следните стъпки:

Ако вече е инсталирано оригиналното приложение Dexcom: Stop Sensor, деинсталирайте приложението от менюто> Настройки> Приложения> Dexcom G5 Mobile> Деинсталиране
Изтеглете модифицираното Dexcom приложение с правилната мерна единица единицаот https://github.com/dexcomapp/dexcomapp?files=1 (ммол / л  или  мг / дл).
Инсталирайте модифицирано приложение Dexcom на смартфона (= изберете изтегления * .apk файл)
Стартирайте модифицираното Dexcom App, активирайте / калибрирайте сензора според указанията и изчакайте фазата на загряване
Ако първите две калибриране са успешни и модифицираното приложение Dexcom показва текущата стойност на кръвната захар, влезте в менюто (= три хоризонтални линии в горния ляв ъгъл на приложението), за да настроите "алармите"
Инсталирайте AAPS
1.	На компютъра / лаптопа , приготвен по описания по-горе начин, отидете на https://github.com/MilosKozak/AndroidAPS
2.	Изберете клон "master" версия 1.58 (по-старите версии не са препоръчителни)
3.	Натиснете бутон за Clone or download > Изберете Download as ZIP
4.	Разархивирайте изтегления ZIP файл в нова папка
5.	Стартирайте Android Studio на компютъра / лаптопа
6.	Следвайте инструкциите на адрес https://github.com/MilosKozak/AndroidAPS/wiki/%D0%A1%D1%8A%D0%B7%D0%B4%D0%B0%D0%B2%D0%B0%D0%BD%D0%B5-%D0%BD%D0%B0-APK
Важно: Използвайте варианта "fullRelease"!

7.	Изтеглете създадения * .apk файл в смартфона / изпратете го по имейл и го инсталирайте там
8.	Стартирайте AAPS в смартфона
9.	От менюто ( трите точки горе в дясно) изберете Preferences, изберете Language, изберете Bulgarian
10.	Направете следните настройки в елемента на менюто "Конфигурация":
a.	Профил: по желание
b.	Инсулин: изберете използвания инсулин
c.	Източник на данни за КЗ: Dexcom G5 приложение(модифицирано), а след това изберете зъбното колело до него, активирайте Качвай данните за КЗ в NS, активирайте Изпрашай  данни за КЗ към xDrip
d.	Помпа: DanaR
e.	Определяне на чувствителност: по желание
f.	Алгоритъм за APS: по желание
g.	Loop: активирайте
h.	Ограничения: Активирайте целите
i.	Treatments: Активирайте лечения
j.	Общи: Действия, Careportal, текущи известия
k.	Активирайте  " NSClient" , а от зъбното колело: NightScout адрес = напишете https://вашетоИме.herokuapp.com, NS API парола = вашата парола за NS, Активирайте Разреши локалното предаване на данни ,  Опции за аларми > деактивирайте всички
Инсталирайте xDrip +
xDrip + е друго важно приложение, което предлага безброй възможности. За разлика от действителното му  предназначение, в нашият случай xDrip +, няма да го ползваме за събиране на данни за КЗ Dexcom G5, а  само за аларми и да ни показва текущата захар ( включително кривата  на предходните захари ) на началния екран на Android  телефона , чрез уиджет. В xDrip + аларми могат в действителност да се настроят много по-индивидуално, отколкото с Dexcom приложението, AAPS или NightScout (няма ограничения в избора на звуци, различни аларми, в зависимост от времето на деня / ноща, и т.н.).

Изтеглете най-новата стабилна версия на APK xDrip + с вашия смартфон от https://xdrip-plus-updates.appspot.com/stable/xdrip-plus-latest.apk , а  не версията от Google Play!

Инсталирайте xDrip +, като изберете изтегления * .apk файл

Стартирайте xDrip + и направете следните настройки в менюто (трите хоризонтални ленти горе вляво):

Settings>Alarms and Alerts>Glucose Level Alert List>Create (low) или (high) alert според нуждите. Съществуващите аларми могат да се променят с дълго натискане върху тях
Settings>Alarms and Alerts> Calibration Alerts: OFF (вече са активни в Dexcom приложението)
Settings>Hardware Data Source> 640G / EverSense
Settings>Inter-app settings>Accept calibrations>ON
От менюто изберете Start sensor  (това е само "про форма" и няма нищо общо с текущия сензор G5, това е необходимо, в противен случай редовно ще се появява съобщение за грешка)
Алармата "<55 mg / dl" се извежда през приложението Dexcom и не може да бъде изключена.

Съвет за срещи / църковни посещения / кино и т.н.: Ако в Samsung Galaxy S7 е активиран режимът "Не безпокойте" (Меню> Настройки> Звуци и вибрация> Не безпокойте: Преместване надясно), тогава смартфонът ще вибрира на алармите от Dexcom приложението(няма да издава звук). За другите аларми, конфигурирани в xDrip +, можете да изберете дали режим „Не безпокойте” да се игнорира или не.

На началния екран на Android, задръжте продължително на свободно място> изберете Виз. елементи> "xDrip +", задръжте и плъзнете до желаното местоположение> пуснете
Деактивирайте опциите за икономия на енергия
В Samsung Galaxy S7 отидете в Меню> Настройки> Поддръжка на устройството> Батерия> Неследени приложения> + Добавяне на приложения: Изберете последователно приложенията AndroidAPS, Dexcom G5 Mobile, xDrip + и вероятно AndroidWear (ако се използва часовникът)
Oпция: Настройте Sony Smartwatch 3 (SWR50)
 
Smartwatch прави живота с диабет дори по-малко забележим. Той може по всяко време да показва на китката - текущата глюкоза, състоянието на цикъла и т.н. и може да се направи болус. Батерията на  SWR50 обикновено издържа цял ден, а самото зареждане е чрез същото зарядно устройство като Samsung Galaxy S7: microUSB).
Часовникът се настройва по следния начин:

•	Инсталирайте приложението "Android Wear" в смартфона чрез Google Play Store и свържете SWR50 според инструкциите там
•	В AAPS в смартфона: Активирайте Конфигурация> Общи>Часовник , а  в зъбното колело до него: Контролиране от часовник = активно
•	В часовника: Settings> Change watchface> AAPSv2
Ако е необходимо, рестартирайте и двете устройства.
Настойка на помпата
виж DanaR инсулинова помпа в секция Конфигуриране
Отказ от отговорност и предупреждение
Цялата информация, мисъл и код са предназначени само за информационни и образователни цели. Понастоящем Nightscout не прави опит за спазване на поверителността на HIPAA. Използвайте Nightscout и AndroidAPS на свой собствен риск и не използвайте информацията или кода, за да вземате медицински решения.

Използването на код или информация от Github.com е без гаранция или формална подкрепа от всякакъв вид. Моля, прегледайте ЛИЦЕНЗИРАНЕТО на това хранилище за подробности.

Всички имена на продукти и компании, търговски марки, марки за услуги, регистрирани търговски марки и регистрирани марки за услуги са собственост на съответните им притежатели. Използването им е за информационни цели и не предполага никаква връзка с тях или одобрение от тях.

Моля, имайте предвид, че този проект няма връзка с и не е одобрен от:
SOOIL
Dexcom
Accu-Chek, Roche Diabetes Care
